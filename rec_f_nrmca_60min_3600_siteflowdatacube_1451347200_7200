SET spark.sql.hive.version=0.13.1
SET spark.sql.parquet.filterPushdown=true
SET spark.sql.hive.convertMetastoreParquet=true
SET spark.sql.parquet.cacheMetadata=true
spark-sql> CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF'; CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), transitbuffer from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451347200 and timestamp <(1451347200+7200) and sourcesiteid = 18 and sourcesitetypeid = 1 and destsiteid = 27 and destsitetypeid = 1 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nJan 19, 2016 5:15:44 AM INFO: parquet.hadoop.ParquetInputFormat: Total input paths to process : 237
Jan 19, 2016 5:15:44 AM INFO: parquet.hadoop.ParquetInputFormat: Total input paths to process : 237
Jan 19, 2016 5:15:44 AM INFO: parquet.hadoop.ParquetFileReader: Initiating action with parallelism: 5
Jan 19, 2016 5:15:44 AM INFO: parquet.hadoop.ParquetFileReader: reading another 237 footers
Jan 19, 2016 5:15:44 AM INFO: parquet.hadoop.ParquetFileReader: Initiating action with parallelism: 5
18	1	-1	22	27	1	-1	0	1	1451347200	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[7.11E7,7.52E7,6.67E7,8.75E7,1.32E8,2.05E8,7.52E7,5.64E7,6.7E7,8.53E7,1.08E8,8.44E7]	[186.0,172.0,182.0,197.0,196.0,213.0,194.0,172.0,190.0,202.0,196.0,180.0]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[0.0103]	[0.0]	
18	1	-1	22	27	1	-1	0	1	1451350800	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[7.7E7,7.0E7,7.19E7,7.2E7,6.3E7,7.0E7,5.45E7,6.98E7,6.22E7,9.74E7,1.014E8,6.12E7]	[173.0,185.0,177.0,185.0,188.0,160.0,171.0,189.0,176.0,172.0,181.0,167.0]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[0.00806]	[0.0]	
18	1	-1	1	27	1	-1	0	2	1451347200	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[0.0,0.0,31000.0,0.0,0.0,13000.0,0.0,0.0,0.0,0.0,0.0,62000.0]	[0.0,0.0,0.25,0.0,0.0,0.25,0.0,0.0,0.0,0.0,0.0,0.5]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[9.81E-7]	[0.0]	
18	1	-1	1	27	1	-1	0	2	1451350800	[42000.0,0.0,0.0,0.0,0.0,0.0,0.0,42000.0,0.0,0.0,0.0,0.0]	[0.0,44000.0,0.0,31000.0,0.0,0.0,0.0,31000.0,0.0,31000.0,0.0,31000.0]	[0.0,0.5,0.0,0.25,0.0,0.0,0.0,0.25,0.0,0.25,0.0,0.25]	[0.25,0.0,0.0,0.0,0.0,0.0,0.0,0.25,0.0,0.0,0.0,0.0]	[1.56E-6]	[7.78E-7]	
18	1	-1	10	27	1	-1	0	2	1451350800	[2.39E7,2.49E7,2.31E7,2.32E7,2.2E7,2.18E7,2.23E7,2.27E7,2.24E7,2.19E7,2.31E7,2.05E7]	[8.3E7,8.49E7,8.05E7,7.99E7,8.08E7,8.24E7,8.56E7,8.13E7,8.21E7,8.13E7,7.94E7,7.82E7]	[224.0,232.0,218.0,217.0,223.0,230.0,224.0,230.0,229.0,223.0,226.0,230.0]	[127000.0,132000.0,118000.0,116000.0,111000.0,107000.0,111000.0,119000.0,116000.0,116000.0,112000.0,104000.0]	[0.00907]	[0.00252]	
18	1	-1	10	27	1	-1	0	2	1451347200	[2.43E7,2.43E7,2.49E7,2.38E7,2.35E7,2.36E7,2.55E7,2.41E7,2.26E7,2.42E7,2.37E7,2.35E7]	[8.86E7,8.85E7,8.51E7,8.25E7,8.48E7,8.42E7,8.61E7,8.47E7,8.21E7,8.36E7,8.22E7,8.41E7]	[215.0,223.0,223.0,221.0,219.0,220.0,226.0,227.0,218.0,221.0,220.0,229.0]	[125000.0,121000.0,126000.0,119000.0,119000.0,124000.0,128000.0,121000.0,110000.0,121000.0,132000.0,112000.0]	[0.00941]	[0.00267]	
18	1	-1	4	27	1	-1	0	2	1451347200	[5.39E8,5.42E8,5.42E8,5.44E8,5.32E8,5.39E8,5.33E8,5.28E8,5.3E8,5.23E8,5.1E8,5.14E8]	[6.18E8,6.2E8,6.33E8,6.24E8,6.24E8,6.16E8,6.11E8,5.97E8,5.95E8,6.04E8,5.82E8,5.93E8]	[5170.0,5240.0,5270.0,5270.0,5190.0,5150.0,5210.0,5050.0,5080.0,5130.0,4950.0,4970.0]	[5420.0,5520.0,5490.0,5470.0,5410.0,5460.0,5370.0,5320.0,5350.0,5300.0,5180.0,5250.0]	[0.0678]	[0.059]	
18	1	-1	4	27	1	-1	0	2	1451350800	[5.15E8,5.12E8,5.03E8,5.19E8,5.06E8,4.98E8,4.99E8,5.07E8,5.01E8,4.99E8,4.94E8,4.87E8]	[5.95E8,5.81E8,5.75E8,5.82E8,5.79E8,5.65E8,5.85E8,5.99E8,5.8E8,5.82E8,5.66E8,5.8E8]	[5000.0,4920.0,4820.0,4960.0,4900.0,4810.0,4920.0,5010.0,4980.0,4880.0,4840.0,4880.0]	[5230.0,5230.0,5160.0,5240.0,5150.0,5040.0,5060.0,5140.0,5150.0,5100.0,5060.0,5010.0]	[0.0645]	[0.0559]	
18	1	-1	22	27	1	-1	0	2	1451347200	[6.95E8,7.17E8,7.93E8,8.27E8,7.76E8,8.67E8,8.73E8,7.81E8,7.21E8,7.72E8,8.38E8,6.91E8]	[6.9E8,5.56E8,6.41E8,7.54E8,8.35E8,9.73E8,7.79E8,8.41E8,7.24E8,6.57E8,7.85E8,7.61E8]	[4750.0,1250.0,1270.0,4280.0,3310.0,2320.0,2330.0,794.0,3810.0,1810.0,1300.0,1800.0]	[58000.0,51500.0,49500.0,56500.0,61500.0,60500.0,66500.0,69500.0,55000.0,62000.0,57000.0,64000.0]	[0.0833]	[0.0866]	
18	1	-1	22	27	1	-1	0	2	1451350800	[5.45E8,5.98E8,5.63E8,6.31E8,6.01E8,5.07E8,5.14E8,6.56E8,6.43E8,6.41E8,7.48E8,6.56E8]	[8.75E8,7.94E8,6.45E8,5.0E8,6.07E8,6.61E8,5.35E8,9.02E8,6.09E8,7.43E8,9.14E8,8.64E8]	[4800.0,1290.0,1280.0,2770.0,1280.0,1780.0,6780.0,3290.0,1780.0,283.0,3790.0,3280.0]	[61000.0,64500.0,60000.0,48000.0,53000.0,49500.0,52500.0,58500.0,49000.0,59500.0,63500.0,61500.0]	[0.0801]	[0.0676]	
18	1	-1	5	27	1	-1	0	2	1451350800	[4.48E8,4.07E8,3.57E8,2.82E8,2.82E8,2.88E8,3.0E8,2.92E8,2.69E8,2.75E8,2.82E8,3.08E8]	[2.72999987E9,2.62E9,2.78E9,2.95000013E9,2.68999987E9,2.88E9,3.06E9,2.95000013E9,2.72E9,2.68E9,3.28999987E9,3.15000013E9]	[706.0,649.0,714.0,713.0,660.0,670.0,676.0,706.0,669.0,680.0,711.0,736.0]	[151.0,138.0,154.0,153.0,135.0,133.0,138.0,142.0,141.0,135.0,125.0,140.0]	[0.319]	[0.0351]	
18	1	-1	5	27	1	-1	0	2	1451347200	[2.82E8,2.64E8,3.03E8,3.07E8,2.94E8,3.21E8,3.66E8,3.93E8,3.42E8,4.04E8,4.53E8,4.0E8]	[2.76999987E9,2.60999987E9,2.8E9,2.51000013E9,2.55000013E9,2.86E9,2.92E9,2.78E9,2.83000013E9,2.94E9,2.88E9,2.76E9]	[707.0,692.0,664.0,681.0,685.0,689.0,699.0,688.0,683.0,698.0,705.0,709.0]	[140.0,144.0,147.0,138.0,158.0,149.0,146.0,141.0,144.0,152.0,147.0,137.0]	[0.307]	[0.0383]	
18	1	-1	-1	27	1	-1	0	7	1451350800	[5.32E7,5.3E7,4.42E7,5.59E7,4.95E7,5.44E7,4.81E7,4.92E7,5.92E7,4.67E7,4.65E7,4.86E7]	[3.0E7,2.25E7,2.26E7,3.01E7,2.06E7,2.19E7,2.69E7,2.15E7,2.8E7,2.71E7,2.27E7,2.79E7]	[39.5,41.0,43.5,44.5,49.5,44.0,41.0,39.5,42.5,45.5,40.5,44.0]	[46000.0,44000.0,38000.0,46000.0,39000.0,45000.0,40000.0,40000.0,47000.0,36000.0,39000.0,40000.0]	[0.0028]	[0.00563]	
18	1	-1	-1	27	1	-1	0	7	1451347200	[4.85E7,6.93E7,5.49E7,5.63E7,6.0E7,5.04E7,4.21E7,5.49E7,5.19E7,5.32E7,5.14E7,6.51E7]	[2.67E7,2.31E7,3.15E7,2.84E7,1.76E7,3.98E7,2.78E7,3.15E7,2.25E7,2.83E7,2.64E7,2.48E7]	[36.5,41.0,40.0,44.5,38.0,46.5,45.5,39.5,42.0,41.5,44.0,45.5]	[40000.0,55000.0,44000.0,45000.0,50000.0,41000.0,34000.0,46000.0,41000.0,45000.0,41000.0,53000.0]	[0.00304]	[0.00609]	
18	1	-1	16	27	1	-1	0	2	1451347200	[1.19E9,1.26E9,1.23E9,1.28E9,1.32E9,9.43E8,1.0E9,1.06E9,1.23E9,1.07E9,1.14E9,1.2E9]	[9.8899999E9,1.04E10,1.03000003E10,1.04999997E10,1.12999997E10,1.03000003E10,9.6300001E9,9.9899996E9,1.08999997E10,1.02200003E10,1.07000003E10,1.02000005E10]	[299000.0,309000.0,319000.0,321000.0,319000.0,307000.0,320000.0,296000.0,289000.0,291000.0,310000.0,312000.0]	[73500.0,77500.0,88500.0,91000.0,98000.0,92000.0,93000.0,85500.0,77500.0,90000.0,101500.0,100500.0]	[1.15]	[0.129]	
18	1	-1	16	27	1	-1	0	2	1451350800	[1.28E9,9.37E8,1.005E9,1.13E9,9.56E8,1.07E9,1.36E9,9.41E8,1.007E9,1.3E9,1.03E9,1.18E9]	[1.10000005E10,1.05999995E10,1.03000003E10,1.05999995E10,1.08999997E10,1.03000003E10,1.03000003E10,9.9500001E9,1.00600003E10,1.01799997E10,9.8299996E9,1.24E10]	[307000.0,292000.0,312000.0,312000.0,306000.0,330000.0,337000.0,308000.0,304000.0,321000.0,304000.0,306000.0]	[100500.0,91000.0,94500.0,86000.0,82500.0,90000.0,101500.0,98500.0,105000.0,94000.0,93500.0,85500.0]	[1.17]	[0.122]	
18	1	-1	-1	27	1	-1	0	2	1451350800	[2.84999987E9,2.95000013E9,2.8E9,2.80999987E9,2.87000013E9,2.8E9,2.88E9,2.84E9,2.92E9,2.9E9,2.87000013E9,2.88E9]	[2.17999995E10,2.14000005E10,2.16E10,2.15000003E10,2.17999995E10,2.22000005E10,2.24E10,2.2799999E10,2.24E10,2.24999997E10,2.25999995E10,2.29000008E10]	[66100.0,67600.0,78100.0,71500.0,73100.0,74500.0,71600.0,67600.0,73500.0,81100.0,74100.0,73600.0]	[409000.0,410000.0,417000.0,397000.0,419000.0,427000.0,413000.0,434000.0,426000.0,432000.0,417000.0,455000.0]	[2.46]	[0.318]	
18	1	-1	-1	27	1	-1	0	2	1451347200	[2.96E9,2.91000013E9,2.80999987E9,2.92999987E9,2.96E9,2.92999987E9,2.9E9,2.92E9,2.84E9,2.78E9,2.76E9,2.86E9]	[2.17999995E10,2.13000008E10,2.14000005E10,2.18999992E10,2.17999995E10,2.22000005E10,2.18999992E10,2.15000003E10,2.21000008E10,2.25999995E10,2.17999995E10,2.16999997E10]	[75100.0,72600.0,72100.0,71600.0,70100.0,71600.0,69100.0,68100.0,68600.0,70600.0,70600.0,67500.0]	[398000.0,374000.0,389000.0,382000.0,381000.0,378000.0,388000.0,414000.0,424000.0,412000.0,420000.0,409000.0]	[2.43]	[0.32]	
spark-sql> Jan 19, 2016 5:19:22 AM INFO: parquet.filter2.compat.FilterCompat: Filtering using predicate: and(and(and(eq(sourcesiteid, 18), eq(sourcesitetypeid, 1)), eq(destsiteid, 27)), eq(destsitetypeid, 1))
Jan 19, 2016 5:19:23 AM INFO: parquet.hadoop.ParquetInputFormat: Total input paths to process : 237
Jan 19, 2016 5:19:23 AM INFO: parquet.hadoop.ParquetInputFormat: Total input paths to process : 237
Jan 19, 2016 5:19:23 AM INFO: parquet.hadoop.ParquetFileReader: Initiating action with parallelism: 5
Jan 19, 2016 5:19:24 AM INFO: parquet.hadoop.ParquetFileReader: reading another 237 footers
Jan 19, 2016 5:19:24 AM INFO: parquet.hadoop.ParquetFileReader: Initiating action with parallelism: 5
