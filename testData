SET spark.sql.hive.version=0.13.1
SET spark.sql.parquet.filterPushdown=true
SET spark.sql.hive.convertMetastoreParquet=true
SET spark.sql.parquet.cacheMetadata=true
spark-sql> CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF'; CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), transitbuffer from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp= 1451192400 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;
180 2   -1  4   8646    3   -1  0   2   1451192400  [24000.0,48000.0,72000.0,0.0,0.0,0.0,0.0,104000.0,0.0,24000.0,96000.0,24000.0]  [0.0,152000.0,98000.0,154000.0,115000.0,112000.0,305000.0,92000.0,158000.0,471000.0,414000.0,204000.0]  [0.0,2000.0,1000.0,1001.0,1000.0,1000.0,3000.0,1000.0,1001.0,5000.0,3000.0,2000.0]  [0.5,1.0,1.5,0.0,0.0,0.0,0.0,1.5,0.0,0.5,2.0,0.5]   [2.11E-5]   [3.63E-6]
18  1   -1  4   7485    3   -1  0   2   1451192400  [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]   [46000.0,156000.0,114000.0,0.0,0.0,198000.0,116000.0,46000.0,24000.0,56000.0,48000.0,46000.0]   [0.5,1.0,1.5,0.0,0.0,1.0,1.0,0.5,0.5,0.5,0.5,0.5]   [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]   [1.57E-5]   [0.0]   000000D900000002
216 2   -1  4   2506    3   -1  0   2   1451192400  [56000.0,134000.0,56000.0,24000.0,56000.0,118000.0,40000.0,24000.0,94000.0,68000.0,138000.0,40000.0]    [1230000.0,1270000.0,768000.0,1060000.0,1450000.0,1050000.0,1590000.0,737000.0,833000.0,897000.0,627000.0,1170000.0]    [12000.0,11000.0,7000.0,9000.0,13000.0,10000.0,12000.0,7000.0,8000.0,8000.0,6000.0,10000.0] [0.5,1.0,0.5,0.5,0.5,1.0,0.5,0.5,1.0,0.5,1.0,0.5]   [1.17E-4]   [7.85E-6]   000000B4000000020000001B00000001000000B300000002
18  1   -1  4   2757    3   -1  0   2   1451192400  [0.0,0.0,81000.0,0.0,80000.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]   [24000.0,0.0,0.0,0.0,38000.0,66000.0,46000.0,0.0,0.0,24000.0,24000.0,118000.0]  [0.5,0.0,0.0,0.0,0.5,0.5,0.5,0.0,0.0,0.5,0.5,1.5]   [0.0,0.0,1000.0,0.0,1000.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0] [6.3E-6]    [2.98E-6]   0000007B00000002