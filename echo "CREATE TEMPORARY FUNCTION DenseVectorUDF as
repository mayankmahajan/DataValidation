echo "CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), DenseVectorUDF(transitbuffer) from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, genericUDAF(transitbuffer) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp=1451192400 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;" |/opt/spark/bin/spark-sql --jars  /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar   --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/f_nrmca_60min_3600_siteflowdatacube_1451192400_transitbuffer


echo "CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select timestamp, nfnameid, isipv6, DenseVectorUDF(T.ByteBuffer), DenseVectorUDF(T.FlowBuffer), DenseVectorUDF(T.CostBuffer) from (select nfnameid, isipv6 , timestamp, genericUDAF(bytebuffer) as ByteBuffer, genericUDAF(flowbuffer) as FlowBuffer, genericUDAF(CostBuffer) as  CostBuffer from  f_nrmca_60min_3600_nfcube where timestamp=1451192400 group by nfnameid, isipv6, timestamp) T;" |/opt/spark/bin/spark-sql --jars  /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar   --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/rec_f_nrmca_60min_3600_nfcube_1451192400

echo "CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, isipv6, timestamp, DenseVectorUDF(T.Downlinkbyte), DenseVectorUDF(T.upLinkByteBuffer), DenseVectorUDF(T.uplinkflowbuffer),  DenseVectorUDF(T.downlinkflowbuffer)  , DenseVectorUDF(T.uplinkcostbuffer), DenseVectorUDF(T.downlinkcostbuffer) from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, isipv6 , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer from  f_nrmca_60min_3600_sitedatacube where timestamp=1451192400 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, isipv6, timestamp) T;" |/opt/spark/bin/spark-sql --jars  /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar   --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/rec_f_nrmca_60min_3600_sitedatacube_1451192400


echo "CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer)from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp=1451192400 and sourcesiteid=18 and sourcesitetypeid=1 and destsitetypeid=1   group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;" |/opt/spark/bin/spark-sql --jars  /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar   --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/f_nrmca_60min_3600_siteflowdatacube_1451192400_18_1_1



echo "CREATE TEMPORARY FUNCTION transitSiteDummyAnnotatorUDF as 'com.guavus.nrmca.densevectorudf.TransitSiteDummyAnnotatorUDF'; CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), DenseVectorUDF(transitbuffer) from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, transitSiteDummyAnnotatorUDF(transitbuffer) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp=1451192400 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;" |/opt/spark/bin/spark-sql --jars  /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar   --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/f_nrmca_60min_3600_siteflowdatacube_1451192400_transitbuffer



echo "CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select DenseVectorUDF(transitbuffer) from (select genericUDAF(transitbuffer) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp=1451192400 ) T;" | /opt/spark/bin/spark-sql --jars /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar,/opt/tms/ib-framework/editservice/editservice-war/WEB-INF/lib/java-ipv6-0.13.jar,/data/instances/acume/1/app/WEB-INF/lib/nrmca-acume-nrmca3.0.jar   --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/f_nrmca_60min_3600_siteflowdatacube_1451192400_transitbuffer

nrmca-acume-nrmca3.0.jar


*****************
CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF';
select hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp=1451192400 and destsiteid = 10989 AND destsitetypeid = 3 AND sourcesiteid = 18 AND sourcesitetypeid = 1;
*****************

******timeStamps******
CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF';
select timestamp, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451192400 and timestamp <(1451192400+86400) and destsiteid = 10989 AND destsitetypeid = 3 AND sourcesiteid = 18 AND sourcesitetypeid = 1 group by timestamp;


CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF';CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db;
select timestamp, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451192400 and timestamp <(1451192400+86400) and destsiteid = 10989 AND destsitetypeid = 3 AND sourcesiteid = 18 AND sourcesitetypeid = 1 group by timestamp;




select timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer), DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), transitbuffer from (select timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451192400 and timestamp <(1451192400+7200) and sourcesiteid = 18 and sourcesitetypeid = 1 group by timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid) T;



select timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , DenseVectorUDF(Downlinkbyte) from (select timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid, genericUDAF(downlinkbytebuffer) as Downlinkbyte  from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451192400 and timestamp <(1451192400+7200) and sourcesiteid = 18 and sourcesitetypeid = 1 group by timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid) T;



echo "CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , DenseVectorUDF(Downlinkbyte) from (select timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid, genericUDAF(downlinkbytebuffer) as Downlinkbyte  from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451347200 and timestamp <(1451347200+7200) and sourcesiteid = 18 and sourcesitetypeid = 1 and destsiteid = 27 and destsitetypeid = 1 group by timestamp, sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid) T;" | /opt/spark/bin/spark-sql --jars /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar,/opt/tms/ib-framework/editservice/editservice-war/WEB-INF/lib/java-ipv6-0.13.jar,/data/instances/acume/1/app/WEB-INF/lib/nrmca-acume-nrmca3.0.jar   --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/temp





echo "CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF'; CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), transitbuffer from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451368800-86400 and timestamp <(1451368800+86400) and sourcesiteid = 18 and sourcesitetypeid = 1 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;" |/opt/spark/bin/spark-sql --jars /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar,/opt/tms/ib-framework/editservice/editservice-war/WEB-INF/lib/java-ipv6-0.13.jar,/data/instances/acume/1/app/WEB-INF/lib/nrmca-acume-nrmca3.0.jar  --master yarn --driver-memory 2G --executor-memory 2G --executor-cores 2 --num-executors 4 >/data/rec_f_nrmca_60min_3600_siteflowdatacube_1451368800_daily






echo "CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, isipv6, timestamp, DenseVectorUDF(T.Downlinkbyte), DenseVectorUDF(T.upLinkByteBuffer), DenseVectorUDF(T.uplinkflowbuffer),  DenseVectorUDF(T.downlinkflowbuffer)  , DenseVectorUDF(T.uplinkcostbuffer), DenseVectorUDF(T.downlinkcostbuffer) from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, isipv6 , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer from  f_nrmca_60min_3600_sitedatacube where timestamp>=1451368800-86400 and timestamp <(1451368800+86400) group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, isipv6, timestamp) T;" |/opt/spark/bin/spark-sql --jars /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar,/opt/tms/ib-framework/editservice/editservice-war/WEB-INF/lib/java-ipv6-0.13.jar,/data/instances/acume/1/app/WEB-INF/lib/nrmca-acume-nrmca3.0.jar  --master yarn --driver-memory 2G --executor-memory 2G --executor-cores 2 --num-executors 4 >/data/rec_f_nrmca_60min_3600_sitedatacube_1451368800_daily




CREATE TEMPORARY FUNCTION transitSiteDummyAnnotatorUDF as 'com.guavus.nrmca.densevectorudf.TransitSiteDummyAnnotatorUDF';
select transitSiteDummyAnnotatorUDF(transitbuffer) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp=1451329200 and destsiteid = 27 AND destsitetypeId = 1 AND sourcesiteid = 18 AND sourcesitetypeid = 1;




echo "CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF'; CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), transitbuffer from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp= 1451192400 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;" |/opt/spark/bin/spark-sql --jars /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar,/opt/tms/ib-framework/editservice/editservice-war/WEB-INF/lib/java-ipv6-0.13.jar,/data/instances/acume/1/app/WEB-INF/lib/nrmca-acume-nrmca3.0.jar  --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/rec_f_nrmca_60min_3600_siteflowdatacube_1451192400_TransitSites



/opt/spark/bin/spark-sql --jars /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar,/opt/tms/ib-framework/editservice/editservice-war/WEB-INF/lib/java-ipv6-0.13.jar,/data/instances/acume/1/app/WEB-INF/lib/nrmca-acume-nrmca3.0.jar















select DenseVectorUDF(transitbuffer) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp=1451192400




method	: 	transitsitedummyannotatorudf
jar 	:	nrmca-acume-nrmca3.0.jar

com.guavus.densevectorudf.transitsitedummyannotatorudf





SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash,T1.SourceSiteId AS SourceSiteId, T1.TransitSiteName AS TransitSiteName, T1.DestSiteTypeId AS DestSiteTypeId, T1.ByteDownlinkAvg AS ByteDownlinkAvg, T2.TransitSiteNameBuffer AS TransitSiteNameBuffer FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, T1.TransitSiteName AS TransitSiteName, averageudf(T1.genericudaf_downlinkbytebuffer) AS ByteDownlinkAvg FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, T1.TransitSiteName AS TransitSiteName, genericudaf(T1.downlinkbytebuffer) AS genericudaf_downlinkbytebuffer FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, transitsitedummyannotatorudf(T1.pathhash) AS TransitSiteName, T1.downlinkbytebuffer AS downlinkbytebuffer FROM (SELECT DestSiteId, SourceSiteTypeId, PathHash, SourceSiteId, DestSiteTypeId, downlinkbytebuffer FROM "SiteFlowDataCube" WHERE ((DestSiteId = 27 AND DestSiteTypeId = 1 AND SourceSiteId = 18 AND SourceSiteTypeId = 1)) AND ts < 1451196000 AND ts >= 1451192400) T1) T1 GROUP BY T1.DestSiteId, T1.SourceSiteTypeId, T1.PathHash, T1.SourceSiteId, T1.DestSiteTypeId, T1.TransitSiteName) T1) T1 FULL JOIN (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, T1.TransitSiteName AS TransitSiteName, transitsiteudaf(T1.transitbuffer) AS TransitSiteNameBuffer FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, transitsitedummyannotatorudf(T1.pathhash) AS TransitSiteName, T1.transitbuffer AS transitbuffer FROM (SELECT DestSiteId, SourceSiteTypeId, PathHash, SourceSiteId, DestSiteTypeId, transitbuffer FROM "SiteFlowDataCube" WHERE ((DestSiteId = 27 AND DestSiteTypeId = 1 AND SourceSiteId = 18 AND SourceSiteTypeId = 1)) AND ts < 1451196000 AND ts >= 1451192400) T1) T1 GROUP BY T1.DestSiteId, T1.SourceSiteTypeId, T1.PathHash, T1.SourceSiteId, T1.DestSiteTypeId, T1.TransitSiteName) T2 ON T1.DestSiteId = T2.DestSiteId AND T1.SourceSiteTypeId = T2.SourceSiteTypeId AND T1.PathHash = T2.PathHash AND T1.SourceSiteId = T2.SourceSiteId AND T1.DestSiteTypeId = T2.DestSiteTypeId AND T1.TransitSiteName = T2.TransitSiteName WHERE rubix_cache_compression_interval = '3600';



SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash,T1.SourceSiteId AS SourceSiteId, T1.TransitSiteName AS TransitSiteName, T1.DestSiteTypeId AS DestSiteTypeId, T1.ByteDownlinkAvg AS ByteDownlinkAvg, T2.TransitSiteNameBuffer AS TransitSiteNameBuffer FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, T1.TransitSiteName AS TransitSiteName, averageudf(T1.genericudaf_downlinkbytebuffer) AS ByteDownlinkAvg FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, T1.TransitSiteName AS TransitSiteName, genericudaf(T1.downlinkbytebuffer) AS genericudaf_downlinkbytebuffer FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, transitsitedummyannotatorudf(T1.pathhash) AS TransitSiteName, T1.downlinkbytebuffer AS downlinkbytebuffer FROM (SELECT DestSiteId, SourceSiteTypeId, PathHash, SourceSiteId, DestSiteTypeId, downlinkbytebuffer FROM f_nrmca_60min_3600_siteflowdatacube WHERE ((DestSiteId = 27 AND DestSiteTypeId = 1 AND SourceSiteId = 18 AND SourceSiteTypeId = 1)) AND ts < 1451196000 AND ts >= 1451192400) T1) T1 GROUP BY T1.DestSiteId, T1.SourceSiteTypeId, T1.PathHash, T1.SourceSiteId, T1.DestSiteTypeId, T1.TransitSiteName) T1) T1 FULL JOIN (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, T1.TransitSiteName AS TransitSiteName, transitsiteudaf(T1.transitbuffer) AS TransitSiteNameBuffer FROM (SELECT T1.DestSiteId AS DestSiteId, T1.SourceSiteTypeId AS SourceSiteTypeId, T1.PathHash AS PathHash, T1.SourceSiteId AS SourceSiteId, T1.DestSiteTypeId AS DestSiteTypeId, transitsitedummyannotatorudf(T1.pathhash) AS TransitSiteName, T1.transitbuffer AS transitbuffer FROM (SELECT DestSiteId, SourceSiteTypeId, PathHash, SourceSiteId, DestSiteTypeId, transitbuffer FROM f_nrmca_60min_3600_siteflowdatacube WHERE ((DestSiteId = 27 AND DestSiteTypeId = 1 AND SourceSiteId = 18 AND SourceSiteTypeId = 1)) AND ts < 1451196000 AND ts >= 1451192400) T1) T1 GROUP BY T1.DestSiteId, T1.SourceSiteTypeId, T1.PathHash, T1.SourceSiteId, T1.DestSiteTypeId, T1.TransitSiteName) T2 ON T1.DestSiteId = T2.DestSiteId AND T1.SourceSiteTypeId = T2.SourceSiteTypeId AND T1.PathHash = T2.PathHash AND T1.SourceSiteId = T2.SourceSiteId AND T1.DestSiteTypeId = T2.DestSiteTypeId AND T1.TransitSiteName = T2.TransitSiteName WHERE rubix_cache_compression_interval = '3600';


CREATE TEMPORARY FUNCTION transitSiteDummyAnnotatorUDF as 'com.guavus.nrmca.densevectorudf.TransitSiteDummyAnnotatorUDF';




echo "CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF'; CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), transitbuffer from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp= 1451347200 and sourcesiteid = 18 and sourcesitetypeid = 1 and destsitetypeid = 3 and destsiteid = 2971 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;" |/opt/spark/bin/spark-sql --jars /opt/tms/java/NrmcaApp.jar,/opt/tms/java/densevectorudf-nrmca3.0.jar,/opt/tms/java/attval-nrmca3.0.jar,/opt/tms/java/attvaludf-nrmca3.0.jar,/opt/tms/ib-framework/editservice/editservice-war/WEB-INF/lib/java-ipv6-0.13.jar,/data/instances/acume/1/app/WEB-INF/lib/nrmca-acume-nrmca3.0.jar  --master yarn --driver-memory 1G --executor-memory 1G --executor-cores 1 --num-executors 2 >/data/rec_f_nrmca_60min_3600_siteflowdatacube_1451347200_TransitSites









