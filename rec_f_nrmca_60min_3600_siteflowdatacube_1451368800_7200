SET spark.sql.hive.version=0.13.1
SET spark.sql.parquet.filterPushdown=true
SET spark.sql.hive.convertMetastoreParquet=true
SET spark.sql.parquet.cacheMetadata=true
spark-sql> CREATE TEMPORARY FUNCTION transitSiteUDAF as 'com.guavus.nrmca.udaf.TransitSiteUDAF'; CREATE TEMPORARY FUNCTION DenseVectorUDF as 'com.guavus.densevectorudf.DenseVectorUDF'; CREATE TEMPORARY FUNCTION peakUDF as 'com.guavus.densevectorudf.PeakDenseVectorUDF'; CREATE TEMPORARY FUNCTION genericUDAF as 'com.guavus.densevectorudf.GenericDenseVectorUDAFResolver'; CREATE TEMPORARY FUNCTION averageUDF as 'com.guavus.densevectorudf.AverageDenseVectorUDF';use RC2_p71_db; select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, DenseVectorUDF(Downlinkbyte), DenseVectorUDF(uplinkbytebuffer), DenseVectorUDF(uplinkflowbuffer),  DenseVectorUDF(downlinkflowbuffer)  , DenseVectorUDF(uplinkcostbuffer), DenseVectorUDF(downlinkcostbuffer), transitbuffer from (select sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp, genericUDAF(downlinkbytebuffer) as Downlinkbyte, genericUDAF(uplinkbytebuffer) as  upLinkByteBuffer, genericUDAF(uplinkflowbuffer) as uplinkflowbuffer,  genericUDAF(downlinkflowbuffer) as downlinkflowbuffer , genericUDAF(uplinkcostbuffer) as  uplinkcostbuffer, genericUDAF(downlinkcostbuffer) as downlinkcostbuffer, hex(transitSiteUDAF(transitbuffer)) as transitbuffer from  f_nrmca_60min_3600_siteflowdatacube where timestamp>=1451368800 and timestamp <(1451368800+7200) and sourcesiteid = 18 and sourcesitetypeid = 1 and destsiteid = 27 and destsitetypeid = 1 group by sourcesiteid, sourcesitetypeid, sourcesiteelementid, nfnameid, destsiteid, destsitetypeid, destsiteelementtypeid, isipv6, vrfid , timestamp) T;
18	1	-1	-1	27	1	-1	0	5	1451368800	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[0.0,0.0,0.0,1150000.0,48500.0,1490000.0,0.0,0.0,58000.0,0.0,58000.0,140000.0]	[0.0,0.0,0.0,1.5,0.5,2.5,0.0,0.0,0.5,0.0,0.5,0.5]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[2.73E-5]	[0.0]	
18	1	-1	-1	27	1	-1	0	5	1451372400	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[0.0,48500.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2600000.0,0.0,0.0]	[0.0,0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[2.45E-5]	[0.0]	
18	1	-1	22	27	1	-1	0	1	1451368800	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[2.61E7,3.64E7,3.35E7,2.62E7,3.65E7,4.04E7,4.36E7,4.67E7,2.67E7,2.33E7,2.32E7,2.04E7]	[74.5,81.0,85.5,69.5,72.0,71.0,67.0,71.5,61.0,73.5,71.5,72.0]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[0.00355]	[0.0]	
18	1	-1	22	27	1	-1	0	1	1451372400	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[2.72E7,3.19E7,4.07E7,3.12E7,2.6E7,3.16E7,2.73E7,1.91E7,1.87E7,2.12E7,2.06E7,2.51E7]	[71.0,72.5,81.5,76.5,70.0,83.0,75.0,65.0,56.5,62.0,62.0,66.5]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[0.00297]	[0.0]	
18	1	-1	1	27	1	-1	0	2	1451368800	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[13000.0,31000.0,0.0,0.0,0.0,0.0,0.0,0.0,39000.0,0.0,0.0,0.0]	[0.25,0.25,0.0,0.0,0.0,0.0,0.0,0.0,0.75,0.0,0.0,0.0]	[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]	[7.69E-7]	[0.0]	
18	1	-1	1	27	1	-1	0	2	1451372400	[0.0,0.0,0.0,0.0,0.0,0.0,45000.0,0.0,0.0,0.0,0.0,0.0]	[0.0,0.0,0.0,0.0,13000.0,65000.0,0.0,0.0,0.0,0.0,0.0,31000.0]	[0.0,0.0,0.0,0.0,0.25,0.5,0.0,0.0,0.0,0.0,0.0,0.25]	[0.0,0.0,0.0,0.0,0.0,0.0,0.25,0.0,0.0,0.0,0.0,0.0]	[1.009E-6]	[4.17E-7]	
18	1	-1	10	27	1	-1	0	2	1451368800	[1.66E7,1.61E7,1.59E7,1.62E7,1.45E7,1.48E7,1.5E7,1.45E7,1.39E7,1.39E7,1.54E7,1.41E7]	[5.71E7,5.67E7,5.37E7,5.3E7,5.46E7,5.04E7,5.16E7,5.28E7,5.08E7,5.26E7,4.96E7,4.95E7]	[238.0,238.0,233.0,234.0,248.0,241.0,244.0,244.0,244.0,250.0,236.0,230.0]	[83600.0,84100.0,79000.0,82000.0,67500.0,69000.0,80000.0,64500.0,67500.0,68000.0,86100.0,71500.0]	[0.00585]	[0.00168]	
18	1	-1	10	27	1	-1	0	2	1451372400	[1.43E7,1.35E7,1.34E7,1.44E7,1.4E7,1.33E7,1.29E7,1.23E7,1.24E7,1.27E7,1.22E7,1.26E7]	[5.01E7,4.6E7,5.04E7,4.64E7,4.96E7,4.77E7,4.56E7,4.65E7,4.51E7,4.59E7,4.57E7,4.54E7]	[237.0,234.0,242.0,241.0,252.0,245.0,245.0,229.0,233.0,228.0,231.0,235.0]	[66000.0,70000.0,70500.0,72000.0,75500.0,72000.0,66500.0,64000.0,64500.0,69100.0,65500.0,66500.0]	[0.00523]	[0.00146]	
18	1	-1	4	27	1	-1	0	2	1451368800	[3.76E8,3.64E8,3.45E8,3.6E8,3.54E8,3.54E8,3.45E8,3.4E8,3.37E8,3.41E8,3.26E8,3.26E8]	[4.1E8,4.05E8,3.92E8,3.88E8,3.81E8,3.83E8,3.77E8,3.69E8,3.64E8,3.63E8,3.53E8,3.6E8]	[3630.0,3600.0,3520.0,3480.0,3410.0,3470.0,3360.0,3340.0,3290.0,3310.0,3190.0,3200.0]	[3890.0,3750.0,3580.0,3700.0,3650.0,3660.0,3560.0,3540.0,3430.0,3450.0,3400.0,3300.0]	[0.0421]	[0.0386]	
18	1	-1	4	27	1	-1	0	2	1451372400	[3.29E8,3.28E8,3.27E8,3.2E8,3.12E8,3.04E8,3.14E8,3.11E8,3.02E8,2.98E8,3.01E8,3.0E8]	[3.56E8,3.62E8,3.5E8,3.4E8,3.32E8,3.43E8,3.31E8,3.26E8,3.18E8,3.24E8,3.2E8,3.23E8]	[3170.0,3210.0,3120.0,3080.0,3080.0,3140.0,3040.0,2990.0,2920.0,2980.0,2910.0,2940.0]	[3330.0,3350.0,3340.0,3300.0,3210.0,3180.0,3240.0,3170.0,3110.0,3070.0,3100.0,3020.0]	[0.0373]	[0.0347]	
18	1	-1	22	27	1	-1	0	2	1451368800	[3.63E8,3.56E8,3.51E8,2.6E8,2.53E8,2.98E8,2.81E8,2.29E8,2.75E8,2.32E8,2.27E8,2.34E8]	[5.14E8,5.39E8,5.62E8,3.89E8,4.45E8,4.69E8,4.74E8,4.97E8,4.29E8,3.52E8,2.9E8,2.98E8]	[3660.0,3660.0,7150.0,3140.0,3640.0,3640.0,129.0,3630.0,1630.0,4150.0,3140.0,2630.0]	[54500.0,52500.0,50500.0,44500.0,50000.0,39000.0,42000.0,38500.0,40000.0,40500.0,39500.0,39500.0]	[0.0487]	[0.0311]	
18	1	-1	22	27	1	-1	0	2	1451372400	[2.8E8,3.42E8,3.43E8,3.73E8,3.79E8,3.78E8,2.61E8,2.15E8,2.15E8,2.71E8,2.54E8,2.89E8]	[2.73E8,2.3E8,3.21E8,2.41E8,2.44E8,3.24E8,2.26E8,2.2E8,3.13E8,2.91E8,1.99E8,1.43E8]	[4130.0,3130.0,1630.0,1640.0,630.0,2630.0,3630.0,1610.0,1610.0,612.0,618.0,609.0]	[43500.0,34000.0,42000.0,37500.0,35000.0,37500.0,34000.0,32000.0,39500.0,41500.0,40500.0,36500.0]	[0.028]	[0.0333]	
18	1	-1	5	27	1	-1	0	2	1451368800	[3.02E8,2.28E8,2.25E8,2.13E8,2.36E8,2.17E8,2.19E8,2.26E8,2.1E8,2.17E8,1.93E8,1.91E8]	[2.96999987E9,2.72999987E9,2.42E9,2.75000013E9,2.87000013E9,2.71000013E9,2.76999987E9,2.8E9,2.59000013E9,2.52E9,2.44E9,2.36E9]	[652.0,615.0,580.0,572.0,566.0,527.0,525.0,579.0,543.0,546.0,510.0,474.0]	[133.0,122.0,121.0,125.0,131.0,125.0,125.0,125.0,125.0,128.0,132.0,117.0]	[0.295]	[0.0248]	
18	1	-1	5	27	1	-1	0	2	1451372400	[2.0E8,1.81E8,1.89E8,1.57E8,1.94E8,1.81E8,1.79E8,1.66E8,1.57E8,1.61E8,1.58E8,1.39E8]	[2.68999987E9,2.44999987E9,2.31000013E9,2.05E9,2.07E9,1.99E9,1.86E9,1.9E9,1.73E9,1.62E9,1.73E9,1.65E9]	[483.0,489.0,479.0,457.0,458.0,427.0,407.0,419.0,395.0,403.0,411.0,391.0]	[119.0,111.0,119.0,117.0,118.0,120.0,121.0,114.0,105.0,102.0,111.0,101.0]	[0.223]	[0.0191]	
18	1	-1	-1	27	1	-1	0	7	1451368800	[2.86E7,3.88E7,3.72E7,2.93E7,3.13E7,3.29E7,3.37E7,4.19E7,3.2E7,2.96E7,3.25E7,3.04E7]	[2.44E7,1.75E7,2.38E7,1.53E7,2.8E7,1.8E7,2.12E7,2.15E7,1.81E7,2.37E7,2.24E7,2.51E7]	[41.0,33.5,40.5,30.0,46.0,40.5,38.0,42.0,38.5,38.0,39.0,37.5]	[24000.0,34000.0,32000.0,25000.0,26000.0,28000.0,28000.0,35000.0,27000.0,25000.0,28000.0,28000.0]	[0.0024]	[0.00369]	
18	1	-1	-1	27	1	-1	0	7	1451372400	[3.12E7,2.46E7,3.52E7,3.96E7,2.56E7,3.57E7,3.39E7,3.86E7,3.1E7,3.38E7,2.48E7,3.38E7]	[2.04E7,2.04E7,2.74E7,2.15E7,1.46E7,2.58E7,2.01E7,2.88E7,2.03E7,2.17E7,1.8E7,1.53E7]	[43.5,38.0,39.5,39.5,32.5,34.5,36.0,41.5,39.5,37.5,35.5,39.0]	[28000.0,23000.0,31000.0,38000.0,23000.0,32000.0,30000.0,35000.0,27000.0,28000.0,21000.0,29000.0]	[0.00235]	[0.00359]	
18	1	-1	16	27	1	-1	0	2	1451368800	[9.76E8,5.6E8,5.97E8,6.22E8,7.07E8,6.39E8,6.36E8,6.7E8,6.02E8,6.32E8,5.7E8,5.15E8]	[7.96E9,7.6600003E9,7.7799997E9,8.16E9,7.4899999E9,8.2899999E9,6.8899999E9,6.6499999E9,7.5000003E9,7.6300001E9,7.32E9,6.6899999E9]	[255000.0,242000.0,241000.0,253000.0,257000.0,253000.0,248000.0,250000.0,241000.0,240000.0,254000.0,225000.0]	[68000.0,66500.0,67500.0,70000.0,69500.0,66000.0,66500.0,66500.0,69500.0,69000.0,65500.0,65500.0]	[0.834]	[0.0715]	
18	1	-1	16	27	1	-1	0	2	1451372400	[4.6E8,5.1E8,5.31E8,5.22E8,5.26E8,5.25E8,4.58E8,4.05E8,4.57E8,4.45E8,4.21E8,4.22E8]	[6.4899999E9,7.0899999E9,6.88E9,6.6700001E9,6.0700001E9,6.0700001E9,5.8300001E9,5.5100001E9,5.5000003E9,5.6600003E9,5.44E9,5.6099999E9]	[230000.0,228000.0,227000.0,221000.0,219000.0,228000.0,197000.0,207000.0,213000.0,214000.0,221000.0,222000.0]	[73000.0,67500.0,63500.0,69000.0,61500.0,71500.0,61500.0,64000.0,63500.0,67000.0,72000.0,67500.0]	[0.674]	[0.0526]	
18	1	-1	-1	27	1	-1	0	2	1451368800	[2.06E9,2.07E9,2.07E9,1.99E9,1.94E9,1.96E9,1.9E9,1.84E9,1.78E9,1.72E9,1.69E9,1.65E9]	[1.7999999E10,1.75000003E10,1.74000005E10,1.68E10,1.63000003E10,1.61999995E10,1.6E10,1.56999997E10,1.48999997E10,1.64999997E10,1.50000005E10,1.43000003E10]	[72000.0,79500.0,67400.0,74000.0,68900.0,71400.0,61900.0,61900.0,62400.0,63400.0,61900.0,63400.0]	[330000.0,347000.0,323000.0,339000.0,326000.0,326000.0,303000.0,317000.0,305000.0,292000.0,287000.0,284000.0]	[1.8]	[0.21]	
18	1	-1	-1	27	1	-1	0	2	1451372400	[1.62E9,1.59E9,1.56E9,1.55E9,1.46E9,1.5E9,1.56E9,1.42E9,1.39E9,1.4E9,1.38E9,1.28E9]	[1.45999995E10,1.44E10,1.40999997E10,1.36999997E10,1.28999997E10,1.29999995E10,1.28999997E10,1.32999997E10,1.23000003E10,1.2E10,1.15000003E10,1.12E10]	[65400.0,60900.0,64900.0,67400.0,65900.0,68400.0,67900.0,68900.0,67800.0,68400.0,65800.0,73800.0]	[311000.0,280000.0,308000.0,285000.0,279000.0,283000.0,275000.0,281000.0,277000.0,247000.0,236000.0,250000.0]	[1.44]	[0.164]	
spark-sql> Jan 19, 2016 5:47:50 AM INFO: parquet.filter2.compat.FilterCompat: Filtering using predicate: and(and(and(eq(sourcesiteid, 18), eq(sourcesitetypeid, 1)), eq(destsiteid, 27)), eq(destsitetypeid, 1))
Jan 19, 2016 5:47:51 AM INFO: parquet.hadoop.ParquetInputFormat: Total input paths to process : 240
Jan 19, 2016 5:47:51 AM INFO: parquet.hadoop.ParquetInputFormat: Total input paths to process : 240
Jan 19, 2016 5:47:51 AM INFO: parquet.hadoop.ParquetFileReader: Initiating action with parallelism: 5
Jan 19, 2016 5:47:51 AM INFO: parquet.hadoop.ParquetFileReader: reading another 240 footers
Jan 19, 2016 5:47:51 AM INFO: parquet.hadoop.ParquetFileReader: Initiating action with parallelism: 5
